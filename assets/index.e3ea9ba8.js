import{a as b,R as E,r as x,I as k,b as f,j as t,g as B,u as F,x as g,f as T,e as y,S as $,i as D,_ as R,P as I,y as S}from"./index.58c1318c.js";import{S as j}from"./index.de7226cd.js";async function L(){return b.send("getNetTasks")}async function _({id:s,data:l}){return b.send("runNetTask",{id:s,data:l})}function M(s,l){const a=x.exports.useContext(k),c=a.prefixCls,i=c===void 0?"arco":c,m=s.spin,h=s.className,u={"aria-hidden":!0,focusable:!1,ref:l,...s,className:`${h?h+" ":""}${i}-icon ${i}-icon-right-circle`};return m&&(u.className=`${u.className} ${i}-icon-loading`),delete u.spin,delete u.isIcon,f("svg",{fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48",...u,children:[t("circle",{cx:"24",cy:"24",r:"18"}),t("path",{d:"M19.485 15.515 27.971 24l-8.486 8.485"})]})}const w=E.forwardRef(M);w.defaultProps={isIcon:!0};w.displayName="IconRightCircle";const P=w,H=({children:s,className:l="",type:a,onClick:c,onGo:i})=>f("div",{className:`flex items-center justify-between relative p-3 w-full cursor-pointer ${["success","fail"].includes(a)?"group":""} ${l}`,onClick:()=>c==null?void 0:c(s),children:[t("span",{children:s}),t(j,{type:a}),t("i",{className:"p-2 absolute right-8 invisible group-hover:visible",onClick:m=>{m.stopPropagation(),i==null||i(s)},children:t(P,{})})]}),U=({onClick:s,onGo:l,list:a})=>t(B,{children:a.map((c,i)=>t(H,{type:c.type,onClick:()=>{s==null||s(c)},onGo:()=>{l==null||l(c)},children:c.title},i))}),{Title:z}=R,O=[],q=()=>{const[s,l]=x.exports.useState(O),[a,c]=x.exports.useState(null),i=F(e=>e.netInfo);x.exports.useEffect(()=>{L().then(e=>{l(e.data)})},[]);const m=e=>{const r=`netTaskResult-${e.id}`,n=document.getElementById(r);n&&n.scrollIntoView({behavior:"smooth",block:"start"})},h=async e=>{var C,A;const r=(o,d)=>{l(v=>v.map(N=>(N.id===o&&(N.type=d),N)))};r(e.id,"loading");let n;const p=await _({id:e.id,data:(A=(C=i==null?void 0:i.dns)==null?void 0:C.value)==null?void 0:A[0]}).catch(o=>{r(e.id,"fail"),console.error("runNetTask:error",o,e),n={data:o==null?void 0:o.data,code:-1}});p&&(n=p),c(o=>o===null?[{id:e.id,content:n.data,title:e.title}]:o.some(d=>d.id===e.id)?o.map(d=>(d.id===e.id&&(d.content=n.data),d)):[...o,{id:e.id,content:n.data,title:e.title}]),p&&r(e.id,"success"),setTimeout(()=>{m({...e})},100)},u=async()=>{if(!a)return;const e=t(I,{data:a==null?void 0:a.map(p=>({title:p.title,content:p.content}))}),r=await S(e).toBlob(),n=document.createElement("a");n.href=URL.createObjectURL(r),n.download=`\u7F51\u7EDC\u8BCA\u65AD\u62A5\u544A-${new Date().format("yyyyMMdd_hhmmss")}.pdf`,n.target="_blank",n.rel="noopener noreferrer",n.click()};return t("div",{className:`${g.container} main`,children:f("div",{className:"flex flex-row w-full flex-1",children:[f("div",{className:"w-[270px] min-w-[270px] flex flex-col flex-none",children:[f(z,{className:"mb-2 ml-1 flex flex-row items-center justify-between",children:[t(T,{position:"right",content:"\u81EA\u52A9\u670D\u52A1\u4E3A\u60A8\u63D0\u4F9B\u4E86\u672C\u673A\u7F51\u7EDC\u73AF\u5883\u7684\u68C0\u6D4B\uFF0C\u5E2E\u52A9\u60A8\u5FEB\u901F\u5C06\u7F51\u7EDC\u8BCA\u65AD\u62A5\u544A\u8F93\u51FA",children:f("div",{className:"flex flex-row items-center",children:[t("svg",{className:"icon mr-1 mt-0.5 cursor-help",children:t("use",{xlinkHref:"#icon-project"})}),t("span",{children:"\u81EA\u52A9\u670D\u52A1"})]})}),t(y,{onClick:()=>{l(s.map(e=>({...e,type:"loading"}))),s.forEach((e,r)=>{setTimeout(()=>{h(e)},r*100+1e3)})},children:"\u5168\u90E8\u8F93\u51FA"})]}),t(U,{list:s,onClick:h,onGo:m})]}),f("div",{className:"flex flex-col w-full ml-4 overflow-hidden",children:[t($,{h:450,className:`flex flex-col items-center w-full ${g["small-screen"]}`,status:"done",nomoreNode:null,children:a&&a.map((e,r)=>t(D,{scale:"1",title:e.title,className:`w-[97.5%] mb-3 ${r===0?"mt-3":""}`,id:`netTaskResult-${e.id}`,itemClassName:"overflow-hidden elipsis",titleClassName:"select-text",children:t("span",{className:"opacity-80 whitespace-pre-wrap select-text",children:e.content})},e.id))}),t("div",{className:"flex flex-row mt-4",children:t(y,{theme:"primary",size:"large",className:"w-full",onClick:u,disabled:a===null,children:"\u4E0B\u8F7D"})})]})]})})};export{q as default};
