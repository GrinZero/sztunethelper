import{a as u,H as c,j as F,n as B,e as b,t as $,v,r as m,o as j,L as D,z as f,J as E,K as N,y as L,N as H}from"./index.c8460947.js";import{l as M}from"./login.0f41ad87.js";const P=({className:n="",onChoose:r,onDelete:a,current:d,data:o})=>u("div",{className:`${c.container} ${n}`,children:o.map(t=>F(B,{className:`cursor-pointer mr-3 min-w-[160px] flex-shrink-0 overflow-hidden ${c.base} ${d===t.username?c.current:""}`,title:t.username,itemClassName:"flex-grow",listClassName:"flex-grow",titleClassName:c.title,onClick:()=>r==null?void 0:r(t),border:!1,children:[u("div",{className:"w-full flex-grow h-full rounded-lg",children:t.packageData}),u("div",{className:`absolute bottom-4 -translate-x-1/2 left-1/2 hidden items-center justify-center ${c["icon-close"]}`,onClick:l=>{l.stopPropagation(),a==null||a(t)},children:u(b,{})})]},t.username))}),z=()=>{const n=$(),r=v(),a=m.exports.useRef(null),[d,o]=m.exports.useState("");m.exports.useEffect(()=>{(async()=>{const i=await window.storage.get("username");o(i||"")})()},[]);const{accountStore:t,currentAccount:l}=j(s=>s.account),[S,p]=m.exports.useState("normal"),y=async s=>{var i,h,g,w,x;try{p("loading");const e=await M(s);if(e.code!==200)throw e;f.success("\u767B\u9646\u6210\u529F"),t.find(A=>A.username===s.username)||n(E({...s,packageData:String(e.data.data)})),n(N(s)),setTimeout(()=>{r.push("/index?refresh")},0)}catch(e){(e==null?void 0:e.code)===502&&((i=e==null?void 0:e.data)==null?void 0:i.code)===-1&&((h=e==null?void 0:e.data)==null?void 0:h.cookies)===null?f.error("\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u8D26\u53F7\u5BC6\u7801\u662F\u5426\u6B63\u786E"):f.error(String((x=(w=(g=e==null?void 0:e.data)==null?void 0:g.message)!=null?w:e==null?void 0:e.code)!=null?x:e))}finally{p("normal")}},C=s=>{!a.current||(n(N(s)),o(s.username),a.current.password&&(a.current.password.value=s.password),a.current.username&&(a.current.username.value=s.username))},k=s=>{L.confirm({title:"\u5220\u9664\u63D0\u793A",content:`\u786E\u8BA4\u5220\u9664${s.username}\u5417\uFF1F`,onOk:()=>{n(H(s))}})};return F("div",{className:"main flex-col items-center",children:[u(D,{className:"w-[60%] mt-16 flex-shrink-0",onSubmit:y,status:S,defaultUserName:l.username,defaultPassword:l.password,ref:a}),t.length>0&&u(P,{onChoose:C,onDelete:k,current:d,data:t,className:"mt-12 w-[85%] min-h-[180px]"})]})};export{z as default};
